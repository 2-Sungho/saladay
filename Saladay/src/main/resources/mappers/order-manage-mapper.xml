<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="orderManageMapper">
	
	<!-- Order resultMap -->
	<resultMap type="OrderManage" id="orderManage_rm">
      <id property="orderNo" column="ORDER_NO"/>
      <result property="orderDate" column="ORDER_DATE"/>
      <result property="packageNo" column="PACKAGE_NO"/>
      <result property="packageName" column="PACKAGE_NAME"/>
      <result property="memberNo" column="MEMBER_NO"/>
      <result property="memberName" column="MEMBER_NAME"/>
      <result property="orderPrice" column="ORDER_PRICE"/>
      <result property="orderDeleteFlag" column="ORDER_DEL_FL"/>
	</resultMap>
	
	<!-- 전체 주문 수 조회 -->
	<select id="getListCount" parameterType="_int" resultType="_int">
	SELECT COUNT(*) FROM "ORDER"
	</select>
	
	<!-- 전체 주문 목록 조회 -->
	<select id="selectOrderList" resultMap="orderManage_rm">
	SELECT ORDER_NO, 
	<![CDATA[
		CASE
	      WHEN TO_CHAR(SYSDATE, 'YYYY-MM-DD')=TO_CHAR(ORDER_DATE, 'YYYY-MM-DD')
	      THEN TO_CHAR(ORDER_DATE, 'HH24:mm:ss')
	      ELSE TO_CHAR(ORDER_DATE, 'YYYY-MM-DD')
	    END ORDER_DATE,
    ]]>
	PACKAGE_NAME, MEMBER_NAME, ORDER_PRICE, ORDER_DEL_FL
	FROM "ORDER"
	JOIN "PACKAGE" USING(PACKAGE_NO)
	JOIN "MEMBER" USING(MEMBER_NO)
	ORDER BY ORDER_NO DESC
	</select>
</mapper>
